---
title: "Wines LDA QDA Classification"
author: "Isabella Chen"
output:
  pdf_document:
    latex_engine: xelatex  # Use xelatex if pdflatex causes issues
date: "2025-04-30"
---

```{r}
library(MASS)    
library(caret)   
library(ggplot2) 
library(caret)  

wine_data <- read.csv("/Users/isabellachen/Downloads/wine-quality-white-and-red.csv")

wine_data$quality_bin <- factor(ifelse(wine_data$quality >= 7, "high", "low"))

# Split into 70/30 train/test
set.seed(1)
train_idx   <- createDataPartition(wine_data$quality_bin, p = 0.7, list = FALSE)
train_data  <- wine_data[train_idx, ]
test_data   <- wine_data[-train_idx, ]

# All predictors except 'quality'
fmla <- as.formula("quality_bin ~ . - quality")

# 4. Fit LDA and QDA
lda_model <- lda(fmla, data = train_data)
qda_model <- qda(fmla, data = train_data)

# 5. Predict on test set
lda_pred <- predict(lda_model, test_data)
qda_pred <- predict(qda_model, test_data)
```


```{r}
# Evaluate LDA model
lda_conf <- confusionMatrix(lda_pred$class, test_data$quality_bin)
cat("LDA Model Performance:\n")
print(lda_conf)
```

```{r}
lda_cm_df <- as.data.frame(lda_conf$table)
colnames(lda_cm_df) <- c("Predicted", "Actual", "Freq")

ggplot(lda_cm_df, aes(x = Actual, y = Predicted, fill = Freq)) +
  geom_tile() +
  geom_text(aes(label = Freq), color = "black") +
  scale_fill_gradient(low = "white", high = "steelblue") +
  labs(title = "LDA Model Confusion Matrix") +
  theme_minimal()
```

```{r}
# Evaluate QDA model
qda_conf <- confusionMatrix(qda_pred$class, test_data$quality_bin)
print("QDA Model Performance:")
print(qda_conf)
```

```{r}
qda_cm_df <- as.data.frame(qda_conf$table)
colnames(qda_cm_df) <- c("Predicted", "Actual", "Freq")

ggplot(qda_cm_df, aes(x = Actual, y = Predicted, fill = Freq)) +
  geom_tile() +
  geom_text(aes(label = Freq), color = "black") +
  scale_fill_gradient(low = "white", high = "darkred") +
  labs(title = "QDA Model Confusion Matrix") +
  theme_minimal()
```

```{r}
# Compare models
models <- c("LDA", "QDA")
accuracies <- c(
  lda_conf$overall["Accuracy"],
  qda_conf$overall["Accuracy"]
)
comparison <- data.frame(Model = models, Accuracy = accuracies)
print(comparison)
```

```{r}
set.seed(1)
# Cross validation with 10 fold
ctrl <- trainControl(method = "cv", number = 10)

lda_cv <- train(
  fmla,
  data      = train_data,
  method    = "lda",
  trControl = ctrl,
  preProcess= "nzv"
)

qda_cv <- train(
  fmla,
  data      = train_data,
  method    = "qda",
  trControl = ctrl,
  preProcess= "nzv"
)

print(lda_cv)
print(qda_cv)
```





